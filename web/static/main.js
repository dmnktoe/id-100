"use strict";(()=>{function h(){let a=document.querySelector(".brand-full"),i=document.querySelector(".brand-compact");a&&sessionStorage.getItem("brandAnimated")==="1"&&(a.classList.add("reverse-animated"),sessionStorage.setItem("brandAnimated","0"),setTimeout(()=>{a.classList.remove("reverse-animated")},800)),i&&sessionStorage.getItem("brandAnimated")!=="1"&&(i.classList.add("animated"),sessionStorage.setItem("brandAnimated","1"))}function m(a){let i=a||document,s=Array.from(i.querySelectorAll("img.lazy"));if(s.length===0)return;let l=e=>{let t=e.getAttribute("data-lqip");t&&(!e.getAttribute("src")||e.getAttribute("src")?.[0]==="#")&&(e.src=t)};if(s.forEach(e=>{if(e.dataset.lazyInitialized)return;e.dataset.lazyInitialized="1";let t=()=>{let o=e.getAttribute("data-src");try{let n=e.currentSrc||e.src||"";(!o||n===o)&&e.classList.add("loaded")}catch{e.classList.add("loaded")}},r=()=>{e.classList.add("loaded")};e.addEventListener("load",t),e.addEventListener("error",r),l(e),e.complete&&(e.naturalWidth&&e.naturalWidth>0?t():r())}),"IntersectionObserver"in window){let e=new IntersectionObserver((t,r)=>{t.forEach(o=>{if(!o.isIntersecting)return;let n=o.target,d=n.getAttribute("data-src");d&&n.src!==d&&(n.src=d),r.unobserve(n)})},{root:null,rootMargin:"200px",threshold:.01});s.forEach(t=>{t.classList.contains("loaded")||e.observe(t)})}else s.forEach(e=>{let t=e.getAttribute("data-src");t&&!e.classList.contains("loaded")&&e.src!==t&&(e.src=t)})}function p(){let a=document.getElementById("drawer-panel"),i=document.getElementById("drawer-backdrop");if(!a||!i)return;function s(e){let t=a.dataset.drawerPushed==="true";document.body.classList.remove("drawer-open"),a.innerHTML="",a.setAttribute("aria-hidden","true"),i.setAttribute("aria-hidden","true"),e&&t&&history.back(),delete a.dataset.drawerPushed}function l(e,t,r,o){a.innerHTML=t,a.setAttribute("aria-hidden","false"),i.setAttribute("aria-hidden","false"),document.body.classList.add("drawer-open");let n=a.querySelector(".drawer-close");n&&n.addEventListener("click",()=>s(!0),{once:!0});let d=a.querySelector(".drawer-back-link");d&&d.addEventListener("click",c=>{c.preventDefault(),s(!0)},{once:!0});try{m(a),Array.from(a.querySelectorAll("img.lazy")).forEach(c=>{let f=c.getAttribute("data-src");f&&c.src!==f&&(c.src=f)})}catch(c){console.warn("initLazyImages failed",c)}if(r){let c=o?`/id/${e}?page=${o}`:`/id/${e}`;history.pushState({drawer:!0,number:e,page:o},"",c),a.dataset.drawerPushed="true"}else a.dataset.drawerPushed="false"}i.addEventListener("click",()=>s(!0)),document.addEventListener("click",e=>{let t=e.target.closest(".id-card");if(!t)return;e.preventDefault();let r=t.getAttribute("href")||t.querySelector("a")?.getAttribute("href");if(!r)return;let o=r.match(/\/id\/(\d+)/);if(!o)return;let n=o[1],c=new URL(r,window.location.origin).searchParams.get("page"),f=c?`/id/${n}?partial=1&page=${c}`:`/id/${n}?partial=1`;fetch(f).then(u=>{if(!u.ok)throw new Error("fetch failed");return u.text()}).then(u=>l(parseInt(n),u,!0,c)).catch(u=>{console.error(u),window.location.href=r})}),document.addEventListener("click",e=>{let t=e.target.closest(".drawer-link");if(!t)return;e.preventDefault();let r=t.getAttribute("href");if(!r)return;let o=r+(r.includes("?")?"&partial=1":"?partial=1");fetch(o).then(n=>{if(!n.ok)throw new Error("fetch failed");return n.text()}).then(n=>l(0,n,!1,null)).catch(n=>{console.error(n),window.location.href=r})}),window.addEventListener("popstate",e=>{if(document.body.classList.contains("drawer-open")){let r=location.pathname.match(/\/id\/(\d+)/);if(r){let o=r[1],n=new URLSearchParams(location.search).get("page"),d=n?`/id/${o}?partial=1&page=${n}`:`/id/${o}?partial=1`;fetch(d).then(c=>c.text()).then(c=>l(parseInt(o),c,!1,n))}else s(!1)}else{let t=location.pathname.match(/\/id\/(\d+)/);if(t&&document.querySelector(".id-grid")){let r=t[1],o=new URLSearchParams(location.search).get("page"),n=o?`/id/${r}?partial=1&page=${o}`:`/id/${r}?partial=1`;fetch(n).then(d=>d.text()).then(d=>l(parseInt(r),d,!1,o))}}})}function g(){document.addEventListener("submit",a=>{let i=a.target;if(!i||i.id!=="requestBagForm")return;a.preventDefault();let s=i.querySelector('input[name="email"]'),l=i.querySelector("button[type=submit]"),e=i.querySelector("#requestResult");if(!s||!l||!e)return;let t=s.value.trim();if(!t||!t.includes("@")){e.style.display="block",e.style.color="#d32f2f",e.innerText="Bitte gib eine g\xFCltige E\u2011Mail an.";return}l.disabled=!0,l.innerText="sende...",fetch("/werkzeug-anfordern",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})}).then(r=>r.json()).then(r=>{r.status==="ok"?i.innerHTML='<p style="font-weight:500;">Danke! Wir benachrichtigen dich per E\u2011Mail, sobald ein Werkzeug verf\xFCgbar ist.</p>':(e.style.display="block",e.style.color="#d32f2f",e.innerText=r.error||"Etwas ging schief.",l.disabled=!1,l.innerText="anfragen")}).catch(r=>{e.style.display="block",e.style.color="#d32f2f",e.innerText="Netzwerkfehler. Bitte versuche es erneut.",l.disabled=!1,l.innerText="anfragen"})})}var b=["\u{1F3E0}","\u{1F194}","\u{1F4AF}","\u{1F6A8}"];function L(a){let i=`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
      <text y="80" font-size="80">${a}</text>
    </svg>
  `;return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(i)}`}function w(){return b[Math.floor(Math.random()*b.length)]}function E(){if(typeof document>"u"||!document.head)return;let a=w(),i=L(a),s=document.querySelector("link[rel~='icon']");s||(s=document.createElement("link"),s.rel="icon",document.head.appendChild(s)),s.href=i}E();h(),p(),g(),m();})();
//# sourceMappingURL=main.js.map
