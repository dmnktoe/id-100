"use strict";(()=>{function L(){let t=document.querySelector(".brand-full"),a=document.querySelector(".brand-compact");t&&sessionStorage.getItem("brandAnimated")==="1"&&(t.classList.add("reverse-animated"),sessionStorage.setItem("brandAnimated","0"),setTimeout(()=>{t.classList.remove("reverse-animated")},800)),a&&sessionStorage.getItem("brandAnimated")!=="1"&&(a.classList.add("animated"),sessionStorage.setItem("brandAnimated","1"))}function g(t){let r=Array.from((t||document).querySelectorAll("img.lazy"));if(r.length===0)return;let c=e=>{let n=e.getAttribute("data-lqip");n&&(!e.getAttribute("src")||e.getAttribute("src")?.[0]==="#")&&(e.src=n)};if(r.forEach(e=>{if(e.dataset.lazyInitialized)return;e.dataset.lazyInitialized="1";let n=()=>{let s=e.getAttribute("data-src");try{let o=e.currentSrc||e.src||"";(!s||o===s)&&e.classList.add("loaded")}catch{e.classList.add("loaded")}},i=()=>{e.classList.add("loaded")};e.addEventListener("load",n),e.addEventListener("error",i),c(e),e.complete&&(e.naturalWidth&&e.naturalWidth>0?n():i())}),"IntersectionObserver"in window){let e=new IntersectionObserver((n,i)=>{n.forEach(s=>{if(!s.isIntersecting)return;let o=s.target,d=o.getAttribute("data-src");d&&o.src!==d&&(o.src=d),i.unobserve(o)})},{root:null,rootMargin:"200px",threshold:.01});r.forEach(n=>{n.classList.contains("loaded")||e.observe(n)})}else r.forEach(e=>{let n=e.getAttribute("data-src");n&&!e.classList.contains("loaded")&&e.src!==n&&(e.src=n)})}function b(){let t=document.getElementById("drawer-panel"),a=document.getElementById("drawer-backdrop");if(!t||!a)return;function r(e){let n=t.dataset.drawerPushed==="true";document.body.classList.remove("drawer-open"),t.innerHTML="",t.setAttribute("aria-hidden","true"),a.setAttribute("aria-hidden","true"),e&&n&&history.back(),delete t.dataset.drawerPushed}function c(e,n,i,s){t.innerHTML=n,t.setAttribute("aria-hidden","false"),a.setAttribute("aria-hidden","false"),document.body.classList.add("drawer-open");let o=t.querySelector(".drawer-close");o&&o.addEventListener("click",()=>r(!0),{once:!0});let d=t.querySelector(".drawer-back-link");d&&d.addEventListener("click",l=>{l.preventDefault(),r(!0)},{once:!0});try{g(t),Array.from(t.querySelectorAll("img.lazy")).forEach(l=>{let f=l.getAttribute("data-src");f&&l.src!==f&&(l.src=f)})}catch(l){console.warn("initLazyImages failed",l)}if(i){let l=s?`/id/${e}?page=${s}`:`/id/${e}`;history.pushState({drawer:!0,number:e,page:s},"",l),t.dataset.drawerPushed="true"}else t.dataset.drawerPushed="false"}a.addEventListener("click",()=>r(!0)),document.addEventListener("click",e=>{let n=e.target.closest(".id-card");if(!n)return;e.preventDefault();let i=n.getAttribute("href")||n.querySelector("a")?.getAttribute("href");if(!i)return;let s=i.match(/\/id\/(\d+)/);if(!s)return;let o=s[1],l=new URL(i,window.location.origin).searchParams.get("page"),f=l?`/id/${o}?partial=1&page=${l}`:`/id/${o}?partial=1`;fetch(f).then(u=>{if(!u.ok)throw new Error("fetch failed");return u.text()}).then(u=>c(parseInt(o),u,!0,l)).catch(u=>{console.error(u),window.location.href=i})}),document.addEventListener("click",e=>{let n=e.target.closest(".drawer-link");if(!n)return;e.preventDefault();let i=n.getAttribute("href");if(!i)return;let s=i+(i.includes("?")?"&partial=1":"?partial=1");fetch(s).then(o=>{if(!o.ok)throw new Error("fetch failed");return o.text()}).then(o=>c(0,o,!1,null)).catch(o=>{console.error(o),window.location.href=i})}),window.addEventListener("popstate",e=>{if(document.body.classList.contains("drawer-open")){let i=location.pathname.match(/\/id\/(\d+)/);if(i){let s=i[1],o=new URLSearchParams(location.search).get("page"),d=o?`/id/${s}?partial=1&page=${o}`:`/id/${s}?partial=1`;fetch(d).then(l=>l.text()).then(l=>c(parseInt(s),l,!1,o))}else r(!1)}else{let n=location.pathname.match(/\/id\/(\d+)/);if(n&&document.querySelector(".id-grid")){let i=n[1],s=new URLSearchParams(location.search).get("page"),o=s?`/id/${i}?partial=1&page=${s}`:`/id/${i}?partial=1`;fetch(o).then(d=>d.text()).then(d=>c(parseInt(i),d,!1,s))}}})}function E(){document.addEventListener("submit",t=>{let a=t.target;if(!a||a.id!=="requestBagForm")return;t.preventDefault();let r=a.querySelector('input[name="email"]'),c=a.querySelector("button[type=submit]"),e=a.querySelector("#requestResult");if(!r||!c||!e)return;let n=r.value.trim();if(!n||!n.includes("@")){e.style.display="block",e.style.color="#d32f2f",e.innerText="Bitte gib eine g\xFCltige E\u2011Mail an.";return}c.disabled=!0,c.innerText="sende...",fetch("/werkzeug-anfordern",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n})}).then(i=>i.json()).then(i=>{i.status==="ok"?a.innerHTML='<p style="font-weight:500;">Danke! Wir benachrichtigen dich per E\u2011Mail, sobald ein Werkzeug verf\xFCgbar ist.</p>':(e.style.display="block",e.style.color="#d32f2f",e.innerText=i.error||"Etwas ging schief.",c.disabled=!1,c.innerText="anfragen")}).catch(i=>{e.style.display="block",e.style.color="#d32f2f",e.innerText="Netzwerkfehler. Bitte versuche es erneut.",c.disabled=!1,c.innerText="anfragen"})})}var y,p=new Set,h=!1;function v(){let t=document.getElementById("playerCity"),a=document.getElementById("cityOptions"),r=document.querySelector(".submit-btn");if(!t||!a)return;let c="";t.addEventListener("input",()=>{let e=t.value.trim();if(h=!1,t.classList.remove("city-selected"),m(r),p.has(e)){h=!0,t.classList.add("city-selected"),m(r);return}e.length<2||e===c||(c=e,y&&clearTimeout(y),y=window.setTimeout(()=>{M(e,a)},300))}),t.addEventListener("change",()=>{let e=t.value.trim();p.has(e)&&(h=!0,t.classList.add("city-selected"),m(r))}),t.addEventListener("blur",()=>{let e=t.value.trim();p.has(e)&&(h=!0,t.classList.add("city-selected"),m(r))})}async function M(t,a){try{let r=window.GEOCODING_API_URL||"http://localhost:8081",c=await fetch(`${r}/indexes/cities/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({q:t,limit:10,attributesToRetrieve:["name"]})});if(!c.ok){console.error("Meilisearch API error:",c.statusText);return}let e=await c.json();a.innerHTML="",p.clear();let n=new Set;e.hits.forEach(i=>{let s=i.name;if(s&&!n.has(s)){n.add(s),p.add(s);let o=document.createElement("option");o.value=s,a.appendChild(o)}})}catch(r){console.error("Error fetching cities:",r)}}function m(t){if(!t)return;let a=document.getElementById("playerName"),r=document.getElementById("agreePrivacy"),c=a&&a.value.trim().length>=2,e=r&&r.checked,n=c&&e&&h;t.disabled=!n}function w(){let t=document.querySelector(".submit-btn"),a=document.getElementById("playerName"),r=document.getElementById("agreePrivacy");!t||!a||!r||(t.disabled=!0,a.addEventListener("input",()=>m(t)),r.addEventListener("change",()=>m(t)))}var T=["\u{1F3E0}","\u{1F194}","\u{1F4AF}","\u{1F6A8}"];function I(t){let a=`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
      <text y="80" font-size="80">${t}</text>
    </svg>
  `;return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(a)}`}function H(){return T[Math.floor(Math.random()*T.length)]}function S(){if(typeof document>"u"||!document.head)return;let t=H(),a=I(t),r=document.querySelector("link[rel~='icon']");r||(r=document.createElement("link"),r.rel="icon",document.head.appendChild(r)),r.href=a}S();L(),b(),E(),v(),w(),g();})();
//# sourceMappingURL=main.js.map
