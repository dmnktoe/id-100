"use strict";(()=>{function h(){let a=document.querySelector(".brand-full"),o=document.querySelector(".brand-compact");a&&sessionStorage.getItem("brandAnimated")==="1"&&(a.classList.add("reverse-animated"),sessionStorage.setItem("brandAnimated","0"),setTimeout(()=>{a.classList.remove("reverse-animated")},800)),o&&sessionStorage.getItem("brandAnimated")!=="1"&&(o.classList.add("animated"),sessionStorage.setItem("brandAnimated","1"))}function m(a){let o=a||document,d=Array.from(o.querySelectorAll("img.lazy"));if(d.length===0)return;let c=e=>{let t=e.getAttribute("data-lqip");t&&(!e.getAttribute("src")||e.getAttribute("src")?.[0]==="#")&&(e.src=t)};if(d.forEach(e=>{if(e.dataset.lazyInitialized)return;e.dataset.lazyInitialized="1";let t=()=>{let s=e.getAttribute("data-src");try{let n=e.currentSrc||e.src||"";(!s||n===s)&&e.classList.add("loaded")}catch{e.classList.add("loaded")}},r=()=>{e.classList.add("loaded")};e.addEventListener("load",t),e.addEventListener("error",r),c(e),e.complete&&(e.naturalWidth&&e.naturalWidth>0?t():r())}),"IntersectionObserver"in window){let e=new IntersectionObserver((t,r)=>{t.forEach(s=>{if(!s.isIntersecting)return;let n=s.target,l=n.getAttribute("data-src");l&&n.src!==l&&(n.src=l),r.unobserve(n)})},{root:null,rootMargin:"200px",threshold:.01});d.forEach(t=>{t.classList.contains("loaded")||e.observe(t)})}else d.forEach(e=>{let t=e.getAttribute("data-src");t&&!e.classList.contains("loaded")&&e.src!==t&&(e.src=t)})}function p(){let a=document.getElementById("drawer-panel"),o=document.getElementById("drawer-backdrop");if(!a||!o)return;function d(e){let t=a.dataset.drawerPushed==="true";document.body.classList.remove("drawer-open"),a.innerHTML="",a.setAttribute("aria-hidden","true"),o.setAttribute("aria-hidden","true"),e&&t&&history.back(),delete a.dataset.drawerPushed}function c(e,t,r,s){a.innerHTML=t,a.setAttribute("aria-hidden","false"),o.setAttribute("aria-hidden","false"),document.body.classList.add("drawer-open");let n=a.querySelector(".drawer-close");n&&n.addEventListener("click",()=>d(!0),{once:!0});let l=a.querySelector(".drawer-back-link");l&&l.addEventListener("click",i=>{i.preventDefault(),d(!0)},{once:!0});try{m(a),Array.from(a.querySelectorAll("img.lazy")).forEach(i=>{let f=i.getAttribute("data-src");f&&i.src!==f&&(i.src=f)})}catch(i){console.warn("initLazyImages failed",i)}if(r){let i=s?`/id/${e}?page=${s}`:`/id/${e}`;history.pushState({drawer:!0,number:e,page:s},"",i),a.dataset.drawerPushed="true"}else a.dataset.drawerPushed="false"}o.addEventListener("click",()=>d(!0)),document.addEventListener("click",e=>{let t=e.target.closest(".id-card");if(!t)return;e.preventDefault();let r=t.getAttribute("href")||t.querySelector("a")?.getAttribute("href");if(!r)return;let s=r.match(/\/id\/(\d+)/);if(!s)return;let n=s[1],i=new URL(r,window.location.origin).searchParams.get("page"),f=i?`/id/${n}?partial=1&page=${i}`:`/id/${n}?partial=1`;fetch(f).then(u=>{if(!u.ok)throw new Error("fetch failed");return u.text()}).then(u=>c(parseInt(n),u,!0,i)).catch(u=>{console.error(u),window.location.href=r})}),document.addEventListener("click",e=>{let t=e.target.closest(".drawer-link");if(!t)return;e.preventDefault();let r=t.getAttribute("href");if(!r)return;let s=r+(r.includes("?")?"&partial=1":"?partial=1");fetch(s).then(n=>{if(!n.ok)throw new Error("fetch failed");return n.text()}).then(n=>c(0,n,!1,null)).catch(n=>{console.error(n),window.location.href=r})}),window.addEventListener("popstate",e=>{if(document.body.classList.contains("drawer-open")){let r=location.pathname.match(/\/id\/(\d+)/);if(r){let s=r[1],n=new URLSearchParams(location.search).get("page"),l=n?`/id/${s}?partial=1&page=${n}`:`/id/${s}?partial=1`;fetch(l).then(i=>i.text()).then(i=>c(parseInt(s),i,!1,n))}else d(!1)}else{let t=location.pathname.match(/\/id\/(\d+)/);if(t&&document.querySelector(".id-grid")){let r=t[1],s=new URLSearchParams(location.search).get("page"),n=s?`/id/${r}?partial=1&page=${s}`:`/id/${r}?partial=1`;fetch(n).then(l=>l.text()).then(l=>c(parseInt(r),l,!1,s))}}})}function b(){document.addEventListener("submit",a=>{let o=a.target;if(!o||o.id!=="requestBagForm")return;a.preventDefault();let d=o.querySelector('input[name="email"]'),c=o.querySelector("button[type=submit]"),e=o.querySelector("#requestResult");if(!d||!c||!e)return;let t=d.value.trim();if(!t||!t.includes("@")){e.style.display="block",e.style.color="#d32f2f",e.innerText="Bitte gib eine g\xFCltige E\u2011Mail an.";return}c.disabled=!0,c.innerText="sende...",fetch("/tasche-anfordern",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})}).then(r=>r.json()).then(r=>{r.status==="ok"?o.innerHTML='<p style="font-weight:500;">Danke! Wir benachrichtigen dich per E\u2011Mail, sobald eine Tasche verf\xFCgbar ist.</p>':(e.style.display="block",e.style.color="#d32f2f",e.innerText=r.error||"Etwas ging schief.",c.disabled=!1,c.innerText="anfragen")}).catch(r=>{e.style.display="block",e.style.color="#d32f2f",e.innerText="Netzwerkfehler. Bitte versuche es erneut.",c.disabled=!1,c.innerText="anfragen"})})}h(),p(),b(),m();})();
//# sourceMappingURL=main.js.map
